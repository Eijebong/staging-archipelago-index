
loader: taskgraph.loader.transform:loader

transforms:
    - src.transforms.create_comment
    - taskgraph.transforms.task

kind-dependencies:
  - diff

tasks:
  apdiff:
    description: Create a comment on the PR with the diff link
    worker-type: githubscript
    run-on-tasks-for: ["github-pull-request", "github-pull-request-untrusted"]
    optimization:
      skip-unless-changed: ["index.toml", "index/**"]
    dependencies:
      diff-index: diff-index
    worker:
      implementation: githubscript-apdiff
      diff-task: {task-reference: <diff-index>}
